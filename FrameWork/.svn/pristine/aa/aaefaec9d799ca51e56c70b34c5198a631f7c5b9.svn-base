using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Drawing;
using System.Data;
using System.Linq;
using System.Text;
using System.Windows.Forms;
using System.Windows.Forms.Design;
using System.ComponentModel.Design;
using System.Data.Linq;
using System.Linq.Expressions;
using FrameWork.EnumLst;

namespace FrameWork
{
    [ToolboxItem(true)]
    [ToolboxBitmap(typeof(ToolStrip))]
    public partial class AcisToolBar : ToolStrip
    {
        public Mode CurrentMode;
        public AcisToolBar()
        {

            InitializeComponent();
            SetMode(Mode.New);


        }

        private static Bol.Permission CurrentPermissionToolBar = new Bol.Permission();

        protected override void OnRightToLeftChanged(EventArgs e)
        {
            base.OnRightToLeftChanged(e);
            if (RightToLeft == System.Windows.Forms.RightToLeft.Yes)
            {
                #region ChangeText
                Btn_New.Text = "جديد";
                Btn_Edit.Text = "تعديل";
                Btn_Delete.Text = "حذف";
                Btn_Save.Text = "حفظ";
                Btn_Refresh.Text = "تحديث";
                Btn_Search.Text = "بحث";
                Btn_Print.Text = "طباعة";
                Btn_First.Text = "الاول";
                Btn_Next.Text = "التالى";
                Btn_Previous.Text = "السابق";
                Btn_Last.Text = "الاخير";
                Btn_Sort.Text = "ترتيب";
                if (Btn_ReSize.Text == "Expand")
                {
                    Btn_ReSize.Text = "توسيع";
                }
                else if (Btn_ReSize.Text == "Collapse")
                {
                    Btn_ReSize.Text = "تصغير";
                }
                else
                {
                    Btn_ReSize.Text = "توسيع";
                }

                Btn_Language.Text = "English";
                Btn_Close.Text = "خروج";

                #endregion
                #region ChangeImage
                Btn_Language.Image = global::FrameWork.Properties.Resources.English;
                Btn_First.Image = global::FrameWork.Properties.Resources.Last;
                Btn_Next.Image = global ::FrameWork.Properties.Resources.Previous;
                Btn_Previous.Image = global::FrameWork.Properties.Resources.Next;
                Btn_Last.Image = global::FrameWork.Properties.Resources.First;
                #endregion
            }

            else
            {
                #region ChangeText
                Btn_New.Text = "New";
                Btn_Edit.Text = "Edit";
                Btn_Delete.Text = "Delete";
                Btn_Save.Text = "Save";
                Btn_Search.Text = "Search";
                Btn_Refresh.Text = "Refresh";
                Btn_Print.Text = "Print";
                Btn_First.Text = "First";
                Btn_Next.Text = "Next";
                Btn_Previous.Text = "Previous";
                Btn_Last.Text = "Last";
                Btn_Sort.Text = "Sort";
                if (Btn_ReSize.Text == "توسيع")
                {
                    Btn_ReSize.Text = "Expand";
                }
                else if (Btn_ReSize.Text == "تصغير")
                {
                    Btn_ReSize.Text = "Collapse";
                }
                else
                {
                    Btn_ReSize.Text = "Expand";
                }
                Btn_Language.Text = "عربي";
                Btn_Close.Text = "Exit";
                #endregion
                #region ChangeImage
                Btn_Language.Image = global::FrameWork.Properties.Resources.Saudi_Arabia_Flag_icon;
                Btn_First.Image = global::FrameWork.Properties.Resources.First;
                Btn_Next.Image = global ::FrameWork.Properties.Resources.Next;
                Btn_Previous.Image = global::FrameWork.Properties.Resources.Previous;
                Btn_Last.Image = global::FrameWork.Properties.Resources.Last;
                #endregion
            }
        }

        public void SetPermission(Bol.Permission CurrentPermission)
        {

            CurrentPermissionToolBar = CurrentPermission;
            Btn_New.Enabled = CurrentPermissionToolBar.Save;
            Btn_Save.Enabled = CurrentPermissionToolBar.Save;
            Btn_Edit.Enabled = CurrentPermissionToolBar.Edit;
            Btn_Delete.Enabled = CurrentPermissionToolBar.Delete;
            Btn_Print.Enabled = CurrentPermissionToolBar.Print;
            Btn_Search.Enabled = CurrentPermissionToolBar.View;
            Btn_First.Enabled = CurrentPermissionToolBar.View;
            Btn_Next.Enabled = CurrentPermissionToolBar.View;
            Btn_Previous.Enabled = CurrentPermissionToolBar.View;
            Btn_Last.Enabled = CurrentPermissionToolBar.View;

            SetMode(Mode.New);
        }

        public void SortGrid<T>(ref DataGridView CurrentGrid, EnumLst.Languages CurrentLanguage, string ColNameAr, string ColNameEn = "")
        {
            Type Cls = typeof(T);
            if (Sort == SortType.Asc)
            {
                if (CurrentLanguage == EnumLst.Languages.Arabic)
                {
                    CurrentGrid.DataSource = ((List<T>)CurrentGrid.DataSource).OrderBy(x => Cls.GetProperty(ColNameAr).GetValue(x, null)).ToList();
                }
                else
                {
                    if (!string.IsNullOrEmpty(ColNameEn))
                    {
                        CurrentGrid.DataSource = ((List<T>)CurrentGrid.DataSource).OrderBy(x => Cls.GetProperty(ColNameEn).GetValue(x, null)).ToList();

                    }
                }
            }

            else
            {
                if (CurrentLanguage == EnumLst.Languages.Arabic)
                {
                    CurrentGrid.DataSource = ((List<T>)CurrentGrid.DataSource).OrderByDescending(x => Cls.GetProperty(ColNameAr).GetValue(x, null)).ToList();
                }
                else
                {
                    if (!string.IsNullOrEmpty(ColNameEn))
                    {
                        CurrentGrid.DataSource = ((List<T>)CurrentGrid.DataSource).OrderByDescending(x => Cls.GetProperty(ColNameEn).GetValue(x, null)).ToList();

                    }
                }
            }
        }

        public void SetMode(Mode ThistMode)
        {
            CurrentMode = ThistMode;
            switch (CurrentMode)
            {
                case Mode.New:
                    if (CurrentPermissionToolBar.Save)
                    {
                        Btn_Save.Enabled = true;
                    }
                    Btn_Edit.Enabled = false;
                    Btn_Delete.Enabled = false;
                    if (dataMode == DataMode.TransactionData)
                        Btn_Print.Enabled = false;

                    break;

                case Mode.Read:
                    Btn_Save.Enabled = false;
                    if (CurrentPermissionToolBar.Edit)
                    {
                        Btn_Edit.Enabled = true;
                    }
                    if (CurrentPermissionToolBar.Delete)
                    {
                        Btn_Delete.Enabled = true;
                    }
                    if (CurrentPermissionToolBar.Print)
                    {
                        Btn_Print.Enabled = true;
                    }
                    break;
                default:
                    break;
            }

        }
        
        private SortType _sort = SortType.Asc;

        public SortType Sort
        {
            get { return _sort; }
            set { _sort = value; }
        }

        private DataMode _dataMode = DataMode.TransactionData;

        public DataMode dataMode
        {
            get { return _dataMode; }
            set
            {
                if (value == DataMode.TransactionData)
                    Btn_Print.Enabled = false;
                else
                    Btn_Print.Enabled = true;

                _dataMode = value;
            }
        }







    }


}
